<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../testing-data/pb-data-faker.html">
<link rel="import" href="../components/pb-color-picker/pb-color-picker.html">
<link rel="import" href="../components/pb-time-series-chart/pb-time-series-chart.html">
<link rel="import" href="../components/pb-project-detail-chart/pb-project-detail-chart.html">
<link rel="import" href="../components/pb-calendar/pb-calendar.html">
<link rel="import" href="../components/pb-project-term/pb-project-term.html">
<link rel="import" href="../components/pb-card/pb-card.html">
<link rel="import" href="../components/pb-project-table/pb-project-table.html">
<link rel="import" href="../components/pb-resource-table/pb-resource-table.html">
<link rel="import" href="../components/pb-project-name/pb-project-name.html">
<link rel="import" href="../components/pb-project-phase/pb-project-phase.html">
<link rel="import" href="../components/pb-project-budget/pb-project-budget.html">

<dom-module id="pb-components-demo">

    <template>
        <style>
             :host {
                display: block;
            }
            
            text {
                font-family: 'CA Sans', 'Helvetica', 'sans-serif';
            }
            
            .container {
                width: 45%;
                vertical-align: top;
                display: inline-block;
            }
            
            .row {
                margin-bottom: 30px;
            }
        </style>
        <div class='test'>
            {{test()}}
        </div>
        <button on-click='generateNewChartData'>Change Data</button> <button on-click='generatePlaceHolderData'>Create Simulated Placeholder</button>
        <pb-time-series-chart data={{chartData}} add-proj-mode=true placeholder-dates={{placeholderData}} placeholder-color={{selectedColor}}></pb-time-series-chart>
        <pb-project-detail-chart data={{projectData}}></pb-project-detail-chart>
        <div class='row'>
            <pb-project-table data={{chartData}}></pb-project-table>
        </div>
        <div class='row'>
            <pb-resource-table data={{resourceData}}></pb-resource-table>
        </div>
        <div class='row'>
            <pb-color-picker selected-color={{selectedColor}}></pb-color-picker>
        </div>
        <div class="row">
            <div class="container">
                <pb-project-term selected-date-range={{placeholderData}}></pb-project-term>
            </div>
            <div class="container">
                <pb-project-name project-name="PiggyBank"></pb-project-name>
            </div>
        </div>
        <div class="row bottom">
            <div class="container phase">
                <pb-project-phase phase="seed2" selected-phase={{selectedPhase}}></pb-project-phase>
            </div>
            <div class="container">
                <pb-project-budget cost=123456789></pb-project-budget>
            </div>
        </div>
        <button on-click='updateSelectedDate'>changeDate</button>
        <pb-calendar month-timestamp={{monthTimestamp}} selected-date={{selectedDate}}></pb-calendar>
    </template>
    <script>
        (function () {
            let fdg = PBProjectWidgetTestDataFaker.fakeDataGenerator;
            class PBComponentsDemo extends Polymer.Element {

                static get is() { return 'pb-components-demo'; }

                constructor() {
                    super();
                }

                static get properties() {
                    return {
                        chartData: {
                            type: Array,
                            notify: true,
                            value: fdg.generateStore(10)
                        },
                        projectData: {
                            type: Object,
                            notify: true,
                            value: fdg.generateStore(1)[0]
                        },
                        resourceData:{
                            type: Array,
                            notify: true,
                            value: function(){
                                let resources = [];
                                for(let i = 0; i < 10; i++){
                                    resources.push(fdg.generateFakeResource());
                                }
                                console.log(resources);
                                return resources;
                            }()
                        },
                        monthTimestamp: {
                            type: Number,
                            notify: true,
                            value: 1458975342788
                        },
                        placeholderData: {
                            type: Object,
                            notify: true,
                            value: {}
                        },
                        tableData: {
                            type: Array,
                            notify: true,
                            value: PBProjectWidgetTestDataFaker.projectData
                        },
                        tableHeaders: {
                            type: Array,
                            notify: true,
                            value: ['Color', 'Project Name', 'Forecasted', 'Actual', '# of People', 'Start Date', 'End Date']
                        },
                        selectedDate: {
                            type: Object,
                            notify: true,
                            value: null
                        },
                        selectedPhase: {
                            type: String
                        },
                        selectedColor: {
                            type: String,
                            value: null,
                            notify: true
                        }

                    }
                }

                generateNewChartData() {
                    this.chartData = PBProjectWidgetTestDataFaker.fakeDataGenerator.generateStore(10);
                }

                generatePlaceHolderData() {
                    let newData = PBProjectWidgetTestDataFaker.fakeDataGenerator.generateStore(1)[0];
                    this.set('placeholderData', {
                        startDate: newData.projectedStartDate,
                        endDate: newData.projectedEndDate,
                    });
                }
                updateSelectedDate() {
                    if (Math.random() > 0.1) {
                        let year = Math.floor(Math.random() * 6) + 2012;
                        let month = Math.floor(Math.random() * 12);
                        let day = Math.floor(Math.random() * 28) + 1;
                        this.selectedDate = new Date(year, month, day);
                    }
                    else this.selectedDate = null;

                }
                test() {
                    return `<div>test342424</div>`;
                }
            }
            customElements.define(PBComponentsDemo.is, PBComponentsDemo);
        })();
    </script>

</dom-module>